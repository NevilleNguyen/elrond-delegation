import{a as N}from"./chunk-B7EZHA3W.js";import{a as b}from"./chunk-WWYZM6K6.js";import{a as w}from"./chunk-JHW32CXC.js";import{c as y,d}from"./chunk-G3PZHPKZ.js";import{h as L}from"./chunk-VMWLEDGI.js";import{h as S}from"./chunk-7RNOZDML.js";import{a as P}from"./chunk-OUEPJKUR.js";import{e as g}from"./chunk-3LKAAPJM.js";import{a as s,j as f,k as A,m as v}from"./chunk-HBP5N4FR.js";v();import{useRef as R}from"react";import{Address as x,SignableMessage as z}from"@multiversx/sdk-core";P();var B=(t,r)=>{var o;return r?r===!0?t:(o=r.apiAddress)!=null?o:t:null},Q=t=>{let r=d(S),o=d(L),c=R(o==null?void 0:o.loginToken),i=B(r.apiAddress,t),a=b(s(s({},t===!0?{}:t),i?{apiAddress:i}:{})),C=Boolean(t),k=N(a),{address:T}=w(),u=y(),M=e=>{c.current=e,u(g(s({loginToken:e},i?{nativeAuthConfig:a}:{})))},p=()=>f(void 0,null,function*(){try{return yield k.initialize()}catch(e){console.error("Unable to get block. Login failed.",e);return}}),h=({address:e,signature:l})=>{let n=c.current;if(!n)throw"Token not found. Call `setLoginToken` first.";if(!C){u(g({loginToken:n,signature:l}));return}let m=k.getToken({address:e,token:n,signature:l});u(g(s({loginToken:n,signature:l,nativeAuthToken:m},i?{nativeAuthConfig:a}:{})))};return{configuration:a,setLoginToken:M,getNativeAuthLoginToken:p,setTokenLoginInfo:h,refreshNativeAuthTokenLogin:l=>f(void 0,[l],function*({signMessageCallback:e}){let n=yield p();if(c.current=n,!n)return;let m=new z({address:new x(T),message:A.Buffer.from(n)}),O=yield e(m,{});h({address:T,signature:O.toJSON().signature})})}};export{Q as a};
//# sourceMappingURL=chunk-XNZGF3PO.js.map
