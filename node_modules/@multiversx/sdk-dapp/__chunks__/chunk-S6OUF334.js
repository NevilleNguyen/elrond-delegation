import{a as ie}from"./chunk-QRY35NB4.js";import{a as re}from"./chunk-WISK7MIJ.js";import{a as oe}from"./chunk-QY7CJB4G.js";import{b as ne}from"./chunk-M263BCY6.js";import{a as y}from"./chunk-QRPURFAS.js";import{a as te}from"./chunk-4JGOLVJN.js";import{a as k}from"./chunk-QCG7SGOX.js";import{a as d}from"./chunk-JASKCX5T.js";import{a as ee}from"./chunk-XNZGF3PO.js";import{a as s,c as $}from"./chunk-QFKT22AW.js";import{c as Q,d as Y,f as Z}from"./chunk-5V4KCOPF.js";import{c as K,d as n}from"./chunk-G3PZHPKZ.js";import{a as J}from"./chunk-ICGFAZ6F.js";import{b as U,c as V,d as _,e as X,f as j,h as q,i as B}from"./chunk-VMWLEDGI.js";import{a as H,g as T}from"./chunk-JLY4442Z.js";import{h as G}from"./chunk-7RNOZDML.js";import{a as ke}from"./chunk-OUEPJKUR.js";import{d as O}from"./chunk-BRLLOUWQ.js";import{c as A,g as M,j as a,k as F}from"./chunk-LHCY2HW6.js";import{e as N,g as P}from"./chunk-3LKAAPJM.js";import{b as D,c as Pe}from"./chunk-EC436OTI.js";import{o as Ae}from"./chunk-K2GW23ZC.js";import{a as h,b as L,j as r,m as z}from"./chunk-HBP5N4FR.js";z();import{useEffect as g,useRef as ye,useState as Ce}from"react";import{ExtensionProvider as be}from"@multiversx/sdk-extension-provider";import{HWProvider as Ie}from"@multiversx/sdk-hw-provider";import{OperaProvider as xe}from"@multiversx/sdk-opera-provider";Pe();ke();Ae();function Ze(){let f=n(G),C=n(_),m=n(U),ae=n(j),c=n(H),b=n(T),i=n(X),I=n(V),x=n(B),[l,se]=Ce(),p=n(q),S=p==null?void 0:p.nativeAuthConfig,ce=ee(S||!1),w=ye(!1),o=K();ie();let{callbackRoute:W,logoutRoute:R}=C||{callbackRoute:"",logoutRoute:""},[le]=oe({callbackRoute:W,logoutRoute:R}),[ue]=ne({callbackRoute:W,logoutRoute:R});g(()=>{de()},[f]),g(()=>{Le()},[m]),g(()=>{fe()},[c,f]),g(()=>{ge()},[b,I,l]);function de(){return r(this,null,function*(){try{let e=yield J();e&&o(O(e.erd_chain_id))}catch(e){console.error("failed refreshing chainId ",e)}})}function ge(){b==null&&i!=null&&l&&o(M({index:i.index,address:c,hasContractDataEnabled:l.dataEnabled,version:l.version}))}function fe(){return r(this,null,function*(){if(o(a(!0)),w.current){w.current=!1,o(a(!1));return}if(c)try{let e=yield k(c);e&&o(A(L(h({},e),{address:c,nonce:e.nonce.valueOf()})))}catch(e){o(F("Failed getting account")),console.error("Failed getting account ",e)}o(a(!1))})}function me(){return r(this,null,function*(){let e=Q(f.walletAddress);if(s(e),ae!=null){try{let t=yield d(),{clearNavigationHistory:u,remainingParams:{signature:E}}=re(["signature","loginToken","address"]);if(!t)return s(Z),o(N(null)),o(P(null)),u();E&&ce.setTokenLoginInfo({signature:E,address:t});let v=yield k(t);v&&(w.current=!0,o(a(!0)),o(D({address:t,loginMethod:"wallet"})),o(A(L(h({},v),{nonce:te(v)}))),o(a(!1))),u()}catch(t){console.error("Failed authenticating wallet user ",t)}o(P(null))}})}function pe(){return r(this,null,function*(){let e=new Ie,t=e.isInitialized();if(t||(t=yield e.init()),!t&&I){console.warn("Could not initialise ledger app"),y(x);return}return(i==null?void 0:i.index)!=null&&(e.addressIndex=i.index),e})}function we(){return r(this,null,function*(){try{let e=yield pe();if(!e)return;let t=yield Y(e);s(e),se(t)}catch(e){console.error("Could not initialise ledger app",e),y(x)}})}function ve(){return r(this,null,function*(){try{let e=yield d(),t=be.getInstance().setAddress(e);(yield t.init())?s(t):console.error("Could not initialise extension, make sure MultiversX wallet extension is installed.")}catch(e){console.error("Unable to login to ExtensionProvider",e)}})}function he(){return r(this,null,function*(){try{let e=yield d(),t=xe.getInstance().setAddress(e);(yield t.init())?s(t):console.error("Could not initialise opera crypto wallet, make sure that opera crypto wallet is installed.")}catch(e){console.error("Unable to login to OperaProvider",e)}})}function Le(){if(m!=null)switch(m){case"ledger":{we();break}case"walletconnect":{le(!1);break}case"walletconnectv2":{ue(!1);break}case"extension":{ve();break}case"opera":{he();break}case"extra":{$();break}case"wallet":case"":{me();break}default:return}}return null}export{Ze as a};
//# sourceMappingURL=chunk-S6OUF334.js.map
