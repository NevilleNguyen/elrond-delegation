import{a as h}from"./chunk-KVVBB443.js";import{a as I}from"./chunk-XNZGF3PO.js";import{a as T}from"./chunk-QFKT22AW.js";import{c as w}from"./chunk-G3PZHPKZ.js";import{a as _}from"./chunk-6AWYFPQL.js";import{a as y}from"./chunk-CSUZ4NMB.js";import{b as u,c as M}from"./chunk-EC436OTI.js";import{h as L,i as G}from"./chunk-QR72MI4M.js";import{o as D}from"./chunk-K2GW23ZC.js";import{a as d,j as f,m}from"./chunk-HBP5N4FR.js";m();G();import{useState as v}from"react";import{OperaProvider as x}from"@multiversx/sdk-opera-provider";M();D();_();var Y=({callbackRoute:n,token:O,nativeAuth:c,onLoginRedirect:S})=>{let[p,E]=v(""),[P,r]=v(!1),k=c!=null,t=I(c),o=O,A=w(),l=h();function F(){return f(this,null,function*(){if(l)throw new Error(L);r(!0);let i=x.getInstance();try{if(!(yield i.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let N=encodeURIComponent(`${window==null?void 0:window.location.origin}${n!=null?n:window==null?void 0:window.location.pathname}`);if(k&&!o&&(o=yield t.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&t.setLoginToken(o);let U=d({callbackUrl:N},o&&{token:o});yield i.login(U),T(i);let{signature:g,address:e}=i.account;if(!e){r(!1),console.warn("Login cancelled.");return}g&&o&&t.setTokenLoginInfo({signature:g,address:e}),A(u({address:e,loginMethod:"opera"})),y({callbackRoute:n,onLoginRedirect:S,options:{signature:g,address:e}})}catch(a){console.error("error loging in",a),E("error logging in"+a.message)}finally{r(!1)}})}let s=Boolean(p);return[F,{loginFailed:s,error:p,isLoading:P&&!s,isLoggedIn:l&&!s}]};export{Y as a};
//# sourceMappingURL=chunk-LFKXTV7X.js.map
