import{a as h}from"./chunk-KVVBB443.js";import{a as I}from"./chunk-XNZGF3PO.js";import{a as T}from"./chunk-QFKT22AW.js";import{c as w}from"./chunk-G3PZHPKZ.js";import{a as M}from"./chunk-6AWYFPQL.js";import{a as y}from"./chunk-CSUZ4NMB.js";import{b as u,c as G}from"./chunk-EC436OTI.js";import{h as L,i as D}from"./chunk-QR72MI4M.js";import{o as U}from"./chunk-K2GW23ZC.js";import{a as d,j as f,m}from"./chunk-HBP5N4FR.js";m();D();import{useState as E}from"react";import{ExtensionProvider as _}from"@multiversx/sdk-extension-provider";G();U();M();var Y=({callbackRoute:n,token:v,nativeAuth:c,onLoginRedirect:S})=>{let[l,x]=E(""),[P,t]=E(!1),O=c!=null,r=I(c),o=v,k=w(),p=h();function A(){return f(this,null,function*(){if(p)throw new Error(L);t(!0);let i=_.getInstance();try{if(!(yield i.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let F=encodeURIComponent(`${window==null?void 0:window.location.origin}${n!=null?n:window==null?void 0:window.location.pathname}`);if(O&&!o&&(o=yield r.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&r.setLoginToken(o);let N=d({callbackUrl:F},o&&{token:o});yield i.login(N),T(i);let{signature:a,address:e}=i.account;if(!e){t(!1),console.warn("Login cancelled.");return}a&&o&&r.setTokenLoginInfo({signature:a,address:e}),k(u({address:e,loginMethod:"extension"})),y({callbackRoute:n,onLoginRedirect:S,options:{signature:a,address:e}})}catch(g){console.error("error loging in",g),x("error logging in"+g.message)}finally{t(!1)}})}let s=Boolean(l);return[A,{loginFailed:s,error:l,isLoading:P&&!s,isLoggedIn:p&&!s}]};export{Y as a};
//# sourceMappingURL=chunk-3IQVAJO6.js.map
