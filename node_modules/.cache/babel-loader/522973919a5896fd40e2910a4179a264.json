{"ast":null,"code":"import _regeneratorRuntime from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _jsxFileName = \"/Users/neville/Documents/Github/elrond-delegation/src/components/Nodes/components/Add/Add.tsx\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { Formik } from 'formik';\nimport { object, array, mixed } from 'yup';\nimport { Submit } from 'components/Action';\nimport { useAction } from 'components/Action/context';\nimport { Dropzone } from 'components/Nodes/components/Dropzone';\nimport useTransaction from 'helpers/useTransaction';\nimport styles from './styles.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var Add = function Add() {\n  _s();\n  var _useTransaction = useTransaction(),\n    sendTransaction = _useTransaction.sendTransaction;\n  var _useAction = useAction(),\n    setShowModal = _useAction.setShowModal;\n  var validationSchema = object().shape({\n    files: array().of(mixed()).required('PEM file is required.').test('validKeyLength', 'Invalid PEM file.', function (value) {\n      return value.every(function (file) {\n        return file.errors && !file.errors.includes('length');\n      });\n    }).test('keyIsUnused', 'Key exists already.', function (value) {\n      return value.every(function (file) {\n        return file.errors && !file.errors.includes('existing');\n      });\n    }).test('keyIsUnique', 'Duplicate key detected!', function (value) {\n      return value.every(function (file) {\n        return file.errors && !file.errors.includes('unique');\n      });\n    })\n  });\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref) {\n      var files, value;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            files = _ref.files;\n            _context.prev = 1;\n            value = files.reduce(function (total, current) {\n              return \"\".concat(total, \"@\").concat(current.pubKey, \"@\").concat(current.signature);\n            }, '');\n            if (!Boolean(value)) {\n              _context.next = 7;\n              break;\n            }\n            _context.next = 6;\n            return sendTransaction({\n              args: value,\n              type: 'addNodes',\n              value: '0'\n            });\n          case 6:\n            setTimeout(function () {\n              return setShowModal(false);\n            }, 250);\n          case 7:\n            _context.next = 12;\n            break;\n          case 9:\n            _context.prev = 9;\n            _context.t0 = _context[\"catch\"](1);\n            console.error(_context.t0);\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[1, 9]]);\n    }));\n    return function onSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxDEV(Formik, {\n    initialValues: {\n      files: []\n    },\n    onSubmit: onSubmit,\n    validationSchema: validationSchema,\n    children: function children(_ref3) {\n      var handleSubmit = _ref3.handleSubmit,\n        errors = _ref3.errors;\n      return /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"\".concat(styles.add, \" add\"),\n        children: [/*#__PURE__*/_jsxDEV(Dropzone, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, _this), errors.files && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.error,\n          children: errors.files\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 28\n        }, _this), /*#__PURE__*/_jsxDEV(Submit, {\n          close: \"Cancel\",\n          submit: \"Save\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, _this);\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 69,\n    columnNumber: 5\n  }, _this);\n};\n_s(Add, \"1jQd7i1PTmDQlEGAKcLisSDDXAI=\", false, function () {\n  return [useTransaction, useAction];\n});\n_c = Add;\nvar _c;\n$RefreshReg$(_c, \"Add\");","map":{"version":3,"names":["React","Formik","object","array","mixed","Submit","useAction","Dropzone","useTransaction","styles","jsxDEV","_jsxDEV","Add","_s","_useTransaction","sendTransaction","_useAction","setShowModal","validationSchema","shape","files","of","required","test","value","every","file","errors","includes","onSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","wrap","_callee$","_context","prev","next","reduce","total","current","concat","pubKey","signature","Boolean","args","type","setTimeout","t0","console","error","stop","_x","apply","arguments","initialValues","children","_ref3","handleSubmit","className","add","fileName","_jsxFileName","lineNumber","columnNumber","_this","close","submit","_c","$RefreshReg$"],"sources":["/Users/neville/Documents/Github/elrond-delegation/src/components/Nodes/components/Add/Add.tsx"],"sourcesContent":["import React from 'react';\n\nimport { Formik } from 'formik';\nimport { object, array, mixed } from 'yup';\n\nimport { Submit } from 'components/Action';\n\nimport { useAction } from 'components/Action/context';\nimport {\n  Dropzone,\n  DropzonePayloadType,\n  DropzoneFormType\n} from 'components/Nodes/components/Dropzone';\nimport useTransaction from 'helpers/useTransaction';\n\nimport styles from './styles.module.scss';\n\nexport const Add = () => {\n  const { sendTransaction } = useTransaction();\n  const { setShowModal } = useAction();\n\n  const validationSchema = object().shape({\n    files: array()\n      .of(mixed())\n      .required('PEM file is required.')\n      .test('validKeyLength', 'Invalid PEM file.', (value: any) =>\n        value.every(\n          (file: DropzonePayloadType) =>\n            file.errors && !file.errors.includes('length')\n        )\n      )\n      .test('keyIsUnused', 'Key exists already.', (value: any) =>\n        value.every(\n          (file: DropzonePayloadType) =>\n            file.errors && !file.errors.includes('existing')\n        )\n      )\n      .test('keyIsUnique', 'Duplicate key detected!', (value: any) =>\n        value.every(\n          (file: DropzonePayloadType) =>\n            file.errors && !file.errors.includes('unique')\n        )\n      )\n  });\n\n  const onSubmit = async ({ files }: DropzoneFormType): Promise<void> => {\n    try {\n      const value = files.reduce(\n        (total: string, current: DropzonePayloadType) =>\n          `${total}@${current.pubKey}@${current.signature}`,\n        ''\n      );\n\n      if (Boolean(value)) {\n        await sendTransaction({\n          args: value,\n          type: 'addNodes',\n          value: '0'\n        });\n\n        setTimeout(() => setShowModal(false), 250);\n      }\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  return (\n    <Formik\n      initialValues={{ files: [] }}\n      onSubmit={onSubmit}\n      validationSchema={validationSchema}\n    >\n      {({ handleSubmit, errors }) => (\n        <form onSubmit={handleSubmit} className={`${styles.add} add`}>\n          <Dropzone />\n\n          {errors.files && <div className={styles.error}>{errors.files}</div>}\n\n          <Submit close='Cancel' submit='Save' />\n        </form>\n      )}\n    </Formik>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}