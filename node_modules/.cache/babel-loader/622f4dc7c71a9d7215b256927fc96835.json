{"ast":null,"code":"import _defineProperty from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _objectSpread from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _toConsumableArray from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _regeneratorRuntime from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _slicedToArray from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nvar _jsxFileName = \"/Users/neville/Documents/Github/elrond-delegation/src/components/Nodes/Nodes.tsx\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React, { useEffect, useState, Fragment, useCallback } from 'react';\nimport { faPlus, faServer, faTimes, faCheck, faExternalLinkAlt, faAngleDown } from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { ContractFunction, Address, Query, BytesValue } from '@multiversx/sdk-core';\nimport { useGetActiveTransactionsStatus } from '@multiversx/sdk-dapp/hooks/transactions/useGetActiveTransactionsStatus';\nimport { useGetSuccessfulTransactions } from '@multiversx/sdk-dapp/hooks/transactions/useGetSuccessfulTransactions';\nimport { ProxyNetworkProvider } from '@multiversx/sdk-network-providers';\nimport classNames from 'classnames';\nimport { Dropdown } from 'react-bootstrap';\nimport { Action } from 'components/Action';\nimport { network, auctionContract, stakingContract } from 'config';\nimport { useGlobalContext } from 'context';\nimport useTransaction from 'helpers/useTransaction';\nimport { Add } from './components/Add';\nimport styles from './styles.module.scss';\nimport variants from './variants.json';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar actions = [{\n  key: 'unStake',\n  label: 'Unstake',\n  callback: function callback(value) {\n    return {\n      value: '0',\n      type: 'unStakeNodes',\n      args: value\n    };\n  }\n}, {\n  key: 'reStake',\n  label: 'ReStake',\n  callback: function callback(value) {\n    return {\n      value: '0',\n      type: 'reStakeUnStakedNodes',\n      args: value\n    };\n  }\n}, {\n  key: 'unJail',\n  label: 'Unjail',\n  callback: function callback(value) {\n    return {\n      value: '2.5',\n      type: 'unJailNodes',\n      args: value\n    };\n  }\n}, {\n  key: 'unBond',\n  label: 'Unbond',\n  callback: function callback(value) {\n    return {\n      value: '0',\n      type: 'unBondNodes',\n      args: value\n    };\n  }\n}, {\n  key: 'stake',\n  label: 'Stake',\n  callback: function callback(value) {\n    return {\n      value: '0',\n      type: 'stakeNodes',\n      args: \"\".concat(value)\n    };\n  }\n}, {\n  key: 'remove',\n  label: 'Remove',\n  callback: function callback(value) {\n    return {\n      value: '0',\n      type: 'removeNodes',\n      args: \"\".concat(value)\n    };\n  }\n}];\nexport var Nodes = function Nodes() {\n  _s();\n  var _useGlobalContext = useGlobalContext(),\n    nodesNumber = _useGlobalContext.nodesNumber,\n    nodesStates = _useGlobalContext.nodesStates;\n  var _useTransaction = useTransaction(),\n    sendTransaction = _useTransaction.sendTransaction;\n  var _useGetActiveTransact = useGetActiveTransactionsStatus(),\n    pending = _useGetActiveTransact.pending;\n  var _useGetSuccessfulTran = useGetSuccessfulTransactions(),\n    hasSuccessfulTransactions = _useGetSuccessfulTran.hasSuccessfulTransactions,\n    successfulTransactionsArray = _useGetSuccessfulTran.successfulTransactionsArray;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    data = _useState2[0],\n    setData = _useState2[1];\n  var isLoading = nodesNumber.status === 'loading';\n  var onAct = useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(parameters) {\n      var value, type, args;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            value = parameters.value, type = parameters.type, args = parameters.args;\n            _context.prev = 1;\n            _context.next = 4;\n            return sendTransaction({\n              args: args,\n              type: type,\n              value: value\n            });\n          case 4:\n            _context.next = 9;\n            break;\n          case 6:\n            _context.prev = 6;\n            _context.t0 = _context[\"catch\"](1);\n            console.error(_context.t0);\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[1, 6]]);\n    }));\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }(), []);\n  var fetchQueue = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(key) {\n      var provider, query, queue, queryContract, payload, _payload$map, _payload$map2, position, size;\n      return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n        while (1) switch (_context3.prev = _context3.next) {\n          case 0:\n            provider = new ProxyNetworkProvider(network.apiAddress);\n            query = new Query({\n              address: new Address(stakingContract),\n              func: new ContractFunction('getQueueIndex'),\n              caller: new Address(auctionContract),\n              args: [BytesValue.fromHex(key)]\n            });\n            queue = new Query({\n              address: new Address(stakingContract),\n              func: new ContractFunction('getQueueSize')\n            });\n            queryContract = /*#__PURE__*/function () {\n              var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(parameters) {\n                var decode, response;\n                return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n                  while (1) switch (_context2.prev = _context2.next) {\n                    case 0:\n                      decode = function decode(item) {\n                        return Buffer.from(item, 'base64');\n                      };\n                      _context2.next = 3;\n                      return provider.queryContract(parameters);\n                    case 3:\n                      response = _context2.sent;\n                      return _context2.abrupt(\"return\", response.returnData.map(decode));\n                    case 5:\n                    case \"end\":\n                      return _context2.stop();\n                  }\n                }, _callee2);\n              }));\n              return function queryContract(_x3) {\n                return _ref3.apply(this, arguments);\n              };\n            }();\n            _context3.next = 6;\n            return Promise.all([query, queue].map(queryContract));\n          case 6:\n            payload = _context3.sent;\n            _payload$map = payload.map(function (_ref4) {\n              var _ref5 = _slicedToArray(_ref4, 1),\n                item = _ref5[0];\n              return String(item);\n            }), _payload$map2 = _slicedToArray(_payload$map, 2), position = _payload$map2[0], size = _payload$map2[1];\n            return _context3.abrupt(\"return\", \"\".concat(position, \"/\").concat(size));\n          case 9:\n          case \"end\":\n            return _context3.stop();\n        }\n      }, _callee3);\n    }));\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), []);\n  var calculateNodes = useCallback(function (nodes) {\n    return nodes.reduce(function (result, value, index, array) {\n      if (index % 2 === 0) {\n        var _array$slice = array.slice(index, index + 2),\n          _array$slice2 = _slicedToArray(_array$slice, 2),\n          code = _array$slice2[0],\n          status = _array$slice2[1];\n        var item = {\n          code: Buffer.from(code, 'base64').toString('hex'),\n          status: Buffer.from(status, 'base64').toString()\n        };\n        return [].concat(_toConsumableArray(result), [_objectSpread(_objectSpread({}, item), {}, {\n          status: variants[item.status]\n        })]);\n      }\n      return result;\n    }, []);\n  }, []);\n  var assignQueue = useCallback(function (nodes) {\n    return nodes.map( /*#__PURE__*/function () {\n      var _ref6 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(node) {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              if (!(node.status.label === 'Queued')) {\n                _context4.next = 11;\n                break;\n              }\n              _context4.t1 = _objectSpread;\n              _context4.t2 = _objectSpread({}, node);\n              _context4.t3 = {};\n              _context4.next = 6;\n              return fetchQueue(node.code);\n            case 6:\n              _context4.t4 = _context4.sent;\n              _context4.t5 = {\n                position: _context4.t4\n              };\n              _context4.t0 = (0, _context4.t1)(_context4.t2, _context4.t3, _context4.t5);\n              _context4.next = 12;\n              break;\n            case 11:\n              _context4.t0 = node;\n            case 12:\n              return _context4.abrupt(\"return\", _context4.t0);\n            case 13:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4);\n      }));\n      return function (_x4) {\n        return _ref6.apply(this, arguments);\n      };\n    }());\n  }, []);\n  var getNodes = function getNodes() {\n    var fetchData = /*#__PURE__*/function () {\n      var _ref7 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(nodes, states) {\n        var activeNodes, inactiveNodes;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.prev = 0;\n              _context5.next = 3;\n              return Promise.all(assignQueue(calculateNodes(nodes)));\n            case 3:\n              activeNodes = _context5.sent;\n              inactiveNodes = states.reduce(function (total, item, index) {\n                var indexes = states.reduce(function (statuses, status, position) {\n                  return Object.keys(variants).includes(String(status)) ? [].concat(_toConsumableArray(statuses), [{\n                    position: position,\n                    status: String(status)\n                  }]) : statuses;\n                }, []);\n                var inactive = function inactive(unit) {\n                  return unit.status === 'notStaked';\n                };\n                var position = indexes.findIndex(inactive);\n                var start = indexes.find(inactive);\n                var end = indexes[position + 1] || {\n                  position: states.length\n                };\n                var node = {\n                  code: item.toString('hex'),\n                  status: variants.notStaked\n                };\n                if (!start || !end) {\n                  return total;\n                }\n                return index > start.position && index < end.position ? [].concat(_toConsumableArray(total), [node]) : total;\n              }, []);\n              setData(activeNodes.concat(inactiveNodes));\n              _context5.next = 11;\n              break;\n            case 8:\n              _context5.prev = 8;\n              _context5.t0 = _context5[\"catch\"](0);\n              console.error(_context5.t0);\n            case 11:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, null, [[0, 8]]);\n      }));\n      return function fetchData(_x5, _x6) {\n        return _ref7.apply(this, arguments);\n      };\n    }();\n    if (nodesNumber.data && nodesStates.data) {\n      fetchData(nodesNumber.data, nodesStates.data);\n    }\n    return function () {\n      return setData([]);\n    };\n  };\n  var refetchNodes = function refetchNodes() {\n    if (hasSuccessfulTransactions && nodesNumber.data && successfulTransactionsArray.length > 0) {\n      getNodes();\n    }\n  };\n  useEffect(getNodes, [nodesNumber.data, nodesStates.data]);\n  useEffect(refetchNodes, [hasSuccessfulTransactions, successfulTransactionsArray.length]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"\".concat(styles.nodes, \" nodes\"),\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.heading,\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: styles.title,\n        children: \"My Nodes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(Action, {\n        title: \"Add Nodes\",\n        disabled: pending,\n        trigger: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classNames(styles.button, _defineProperty({}, styles.disabled, pending)),\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.icon,\n            children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n              icon: faPlus\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Add Nodes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 15\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 13\n        }, _this),\n        render: function render() {\n          return /*#__PURE__*/_jsxDEV(Add, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 25\n          }, _this);\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.body,\n      children: isLoading || nodesNumber.error || data.length === 0 ? /*#__PURE__*/_jsxDEV(Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.server,\n          children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n            icon: faServer,\n            size: \"2x\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 294,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 13\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.message,\n          children: isLoading ? 'Retrieving keys...' : nodesNumber.error ? 'An error occurred attempting to retrieve keys.' : 'No keys found for this contract.'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 11\n      }, _this) : data.map(function (node) {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.node,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.left,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.icon,\n              children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faServer\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 310,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 17\n            }, _this), /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"\".concat(network.explorerAddress, \"/nodes/\").concat(node.code),\n              target: \"_blank\",\n              rel: \"noreferrer\",\n              className: styles.link,\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: styles.code,\n                children: node.code\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 319,\n                columnNumber: 19\n              }, _this), /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                icon: faExternalLinkAlt\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 321,\n                columnNumber: 19\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 15\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.right,\n            children: [node.status && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: classNames(styles.status, styles[node.status.color]),\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: styles.icon,\n                children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                  icon: node.status.color === 'success' ? faCheck : faTimes,\n                  size: \"sm\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 334,\n                  columnNumber: 23\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 333,\n                columnNumber: 21\n              }, _this), node.position ? \"\".concat(node.status.label, \" (Position \").concat(node.position, \")\") : node.status.label]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 19\n            }, _this), /*#__PURE__*/_jsxDEV(Dropdown, {\n              children: [/*#__PURE__*/_jsxDEV(Dropdown.Toggle, {\n                className: classNames(styles.toggle, _defineProperty({}, styles.disabled, pending)),\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Action\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 354,\n                  columnNumber: 21\n                }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: styles.angle,\n                  children: /*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n                    icon: faAngleDown\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 357,\n                    columnNumber: 23\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 356,\n                  columnNumber: 21\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 19\n              }, _this), /*#__PURE__*/_jsxDEV(Dropdown.Menu, {\n                className: styles.menu,\n                children: actions.map(function (action) {\n                  var disabled = !node.status.actions.includes(action.key);\n                  return /*#__PURE__*/_jsxDEV(Dropdown.Item, {\n                    className: classNames(styles.action, _defineProperty({}, styles.disabled, disabled)),\n                    onClick: function onClick() {\n                      onAct(action.callback(node.code));\n                    },\n                    children: action.label\n                  }, action.key, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 368,\n                    columnNumber: 25\n                  }, _this);\n                })\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 361,\n                columnNumber: 19\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 15\n          }, _this)]\n        }, node.code, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 13\n        }, _this);\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 267,\n    columnNumber: 5\n  }, _this);\n};\n_s(Nodes, \"p0QhDl/ZXQRwFvzKQox98gqvefw=\", false, function () {\n  return [useGlobalContext, useTransaction, useGetActiveTransactionsStatus, useGetSuccessfulTransactions];\n});\n_c = Nodes;\nvar _c;\n$RefreshReg$(_c, \"Nodes\");","map":{"version":3,"names":["React","useEffect","useState","Fragment","useCallback","faPlus","faServer","faTimes","faCheck","faExternalLinkAlt","faAngleDown","FontAwesomeIcon","ContractFunction","Address","Query","BytesValue","useGetActiveTransactionsStatus","useGetSuccessfulTransactions","ProxyNetworkProvider","classNames","Dropdown","Action","network","auctionContract","stakingContract","useGlobalContext","useTransaction","Add","styles","variants","jsxDEV","_jsxDEV","actions","key","label","callback","value","type","args","concat","Nodes","_s","_useGlobalContext","nodesNumber","nodesStates","_useTransaction","sendTransaction","_useGetActiveTransact","pending","_useGetSuccessfulTran","hasSuccessfulTransactions","successfulTransactionsArray","_useState","_useState2","_slicedToArray","data","setData","isLoading","status","onAct","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","parameters","wrap","_callee$","_context","prev","next","t0","console","error","stop","_x","apply","arguments","fetchQueue","_ref2","_callee3","provider","query","queue","queryContract","payload","_payload$map","_payload$map2","position","size","_callee3$","_context3","apiAddress","address","func","caller","fromHex","_ref3","_callee2","decode","response","_callee2$","_context2","item","Buffer","from","sent","abrupt","returnData","map","_x3","Promise","all","_ref4","_ref5","String","_x2","calculateNodes","nodes","reduce","result","index","array","_array$slice","slice","_array$slice2","code","toString","_toConsumableArray","_objectSpread","assignQueue","_ref6","_callee4","node","_callee4$","_context4","t1","t2","t3","t4","t5","_x4","getNodes","fetchData","_ref7","_callee5","states","activeNodes","inactiveNodes","_callee5$","_context5","total","indexes","statuses","Object","keys","includes","inactive","unit","findIndex","start","find","end","length","notStaked","_x5","_x6","refetchNodes","className","children","heading","title","fileName","_jsxFileName","lineNumber","columnNumber","_this","disabled","trigger","button","_defineProperty","icon","render","body","server","message","left","href","explorerAddress","target","rel","link","right","color","Toggle","toggle","angle","Menu","menu","action","Item","onClick","_c","$RefreshReg$"],"sources":["/Users/neville/Documents/Github/elrond-delegation/src/components/Nodes/Nodes.tsx"],"sourcesContent":["import React, { useEffect, useState, Fragment, useCallback } from 'react';\nimport {\n  faPlus,\n  faServer,\n  faTimes,\n  faCheck,\n  faExternalLinkAlt,\n  faAngleDown\n} from '@fortawesome/free-solid-svg-icons';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  ContractFunction,\n  Address,\n  Query,\n  BytesValue\n} from '@multiversx/sdk-core';\nimport { useGetActiveTransactionsStatus } from '@multiversx/sdk-dapp/hooks/transactions/useGetActiveTransactionsStatus';\nimport { useGetSuccessfulTransactions } from '@multiversx/sdk-dapp/hooks/transactions/useGetSuccessfulTransactions';\nimport { ProxyNetworkProvider } from '@multiversx/sdk-network-providers';\nimport classNames from 'classnames';\nimport { Dropdown } from 'react-bootstrap';\n\nimport { Action } from 'components/Action';\nimport { network, auctionContract, stakingContract } from 'config';\nimport { useGlobalContext } from 'context';\nimport useTransaction from 'helpers/useTransaction';\n\nimport { Add } from './components/Add';\n\nimport styles from './styles.module.scss';\n\nimport variants from './variants.json';\n\ninterface NodeType {\n  code: string;\n  status: any;\n  position?: string;\n}\n\ninterface VariantsType {\n  [key: string]: any;\n}\n\ninterface ArgumentsType {\n  value: string;\n  type: string;\n  args: string;\n}\n\ninterface ActionsType {\n  key: string;\n  label: string;\n  callback: (value: string) => ArgumentsType;\n}\n\nconst actions: ActionsType[] = [\n  {\n    key: 'unStake',\n    label: 'Unstake',\n    callback: (value: string) => ({\n      value: '0',\n      type: 'unStakeNodes',\n      args: value\n    })\n  },\n  {\n    key: 'reStake',\n    label: 'ReStake',\n    callback: (value: string) => ({\n      value: '0',\n      type: 'reStakeUnStakedNodes',\n      args: value\n    })\n  },\n  {\n    key: 'unJail',\n    label: 'Unjail',\n    callback: (value: string) => ({\n      value: '2.5',\n      type: 'unJailNodes',\n      args: value\n    })\n  },\n  {\n    key: 'unBond',\n    label: 'Unbond',\n    callback: (value: string) => ({\n      value: '0',\n      type: 'unBondNodes',\n      args: value\n    })\n  },\n  {\n    key: 'stake',\n    label: 'Stake',\n    callback: (value: string) => ({\n      value: '0',\n      type: 'stakeNodes',\n      args: `${value}`\n    })\n  },\n  {\n    key: 'remove',\n    label: 'Remove',\n    callback: (value: string) => ({\n      value: '0',\n      type: 'removeNodes',\n      args: `${value}`\n    })\n  }\n];\n\nexport const Nodes = () => {\n  const { nodesNumber, nodesStates } = useGlobalContext();\n  const { sendTransaction } = useTransaction();\n  const { pending } = useGetActiveTransactionsStatus();\n  const { hasSuccessfulTransactions, successfulTransactionsArray } =\n    useGetSuccessfulTransactions();\n\n  const [data, setData] = useState<NodeType[]>([]);\n  const isLoading = nodesNumber.status === 'loading';\n\n  const onAct = useCallback(\n    async (parameters: ArgumentsType): Promise<void> => {\n      const { value, type, args } = parameters;\n\n      try {\n        await sendTransaction({\n          args,\n          type,\n          value\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    []\n  );\n\n  const fetchQueue = useCallback(async (key: string) => {\n    const provider = new ProxyNetworkProvider(network.apiAddress);\n    const query = new Query({\n      address: new Address(stakingContract),\n      func: new ContractFunction('getQueueIndex'),\n      caller: new Address(auctionContract),\n      args: [BytesValue.fromHex(key)]\n    });\n\n    const queue = new Query({\n      address: new Address(stakingContract),\n      func: new ContractFunction('getQueueSize')\n    });\n\n    const queryContract = async (parameters: Query) => {\n      const decode = (item: string) => Buffer.from(item, 'base64');\n      const response = await provider.queryContract(parameters);\n\n      return response.returnData.map(decode);\n    };\n\n    const payload = await Promise.all([query, queue].map(queryContract));\n    const [position, size] = payload.map(([item]) => String(item));\n\n    return `${position}/${size}`;\n  }, []);\n\n  const calculateNodes = useCallback(\n    (nodes: any[]) =>\n      nodes.reduce((result: any, value, index, array) => {\n        if (index % 2 === 0) {\n          const [code, status]: any[] = array.slice(index, index + 2);\n          const item: any = {\n            code: Buffer.from(code, 'base64').toString('hex'),\n            status: Buffer.from(status, 'base64').toString()\n          };\n\n          return [\n            ...result,\n            {\n              ...item,\n              status: (variants as VariantsType)[item.status]\n            }\n          ];\n        }\n        return result;\n      }, []),\n    []\n  );\n\n  const assignQueue = useCallback(\n    (nodes: NodeType[]) =>\n      nodes.map(async (node: NodeType) =>\n        node.status.label === 'Queued'\n          ? {\n              ...node,\n              position: await fetchQueue(node.code)\n            }\n          : node\n      ),\n    []\n  );\n\n  const getNodes = () => {\n    const fetchData = async (nodes: any[], states: any[]) => {\n      try {\n        const activeNodes = await Promise.all(\n          assignQueue(calculateNodes(nodes))\n        );\n        const inactiveNodes = states.reduce((total, item, index) => {\n          const indexes = states.reduce(\n            (statuses, status, position) =>\n              Object.keys(variants).includes(String(status))\n                ? [...statuses, { position, status: String(status) }]\n                : statuses,\n            []\n          );\n\n          const inactive = (unit: any) => unit.status === 'notStaked';\n          const position = indexes.findIndex(inactive);\n          const start = indexes.find(inactive);\n          const end = indexes[position + 1] || { position: states.length };\n\n          const node: any = {\n            code: item.toString('hex'),\n            status: variants.notStaked\n          };\n\n          if (!start || !end) {\n            return total;\n          }\n\n          return index > start.position && index < end.position\n            ? [...total, node]\n            : total;\n        }, []);\n\n        setData(activeNodes.concat(inactiveNodes));\n      } catch (error) {\n        console.error(error);\n      }\n    };\n\n    if (nodesNumber.data && nodesStates.data) {\n      fetchData(nodesNumber.data, nodesStates.data);\n    }\n\n    return () => setData([]);\n  };\n\n  const refetchNodes = () => {\n    if (\n      hasSuccessfulTransactions &&\n      nodesNumber.data &&\n      successfulTransactionsArray.length > 0\n    ) {\n      getNodes();\n    }\n  };\n\n  useEffect(getNodes, [nodesNumber.data, nodesStates.data]);\n  useEffect(refetchNodes, [\n    hasSuccessfulTransactions,\n    successfulTransactionsArray.length\n  ]);\n\n  return (\n    <div className={`${styles.nodes} nodes`}>\n      <div className={styles.heading}>\n        <span className={styles.title}>My Nodes</span>\n\n        <Action\n          title='Add Nodes'\n          disabled={pending}\n          trigger={\n            <div\n              className={classNames(styles.button, {\n                [styles.disabled]: pending\n              })}\n            >\n              <div className={styles.icon}>\n                <FontAwesomeIcon icon={faPlus} />\n              </div>\n              <span>Add Nodes</span>\n            </div>\n          }\n          render={() => <Add />}\n        />\n      </div>\n\n      <div className={styles.body}>\n        {isLoading || nodesNumber.error || data.length === 0 ? (\n          <Fragment>\n            <div className={styles.server}>\n              <FontAwesomeIcon icon={faServer} size='2x' />\n            </div>\n\n            <div className={styles.message}>\n              {isLoading\n                ? 'Retrieving keys...'\n                : nodesNumber.error\n                ? 'An error occurred attempting to retrieve keys.'\n                : 'No keys found for this contract.'}\n            </div>\n          </Fragment>\n        ) : (\n          data.map((node: NodeType) => (\n            <div key={node.code} className={styles.node}>\n              <div className={styles.left}>\n                <span className={styles.icon}>\n                  <FontAwesomeIcon icon={faServer} />\n                </span>\n\n                <a\n                  href={`${network.explorerAddress}/nodes/${node.code}`}\n                  target='_blank'\n                  rel='noreferrer'\n                  className={styles.link}\n                >\n                  <span className={styles.code}>{node.code}</span>\n\n                  <FontAwesomeIcon icon={faExternalLinkAlt} />\n                </a>\n              </div>\n\n              <div className={styles.right}>\n                {node.status && (\n                  <span\n                    className={classNames(\n                      styles.status,\n                      styles[node.status.color]\n                    )}\n                  >\n                    <span className={styles.icon}>\n                      <FontAwesomeIcon\n                        icon={\n                          node.status.color === 'success' ? faCheck : faTimes\n                        }\n                        size='sm'\n                      />\n                    </span>\n\n                    {node.position\n                      ? `${node.status.label} (Position ${node.position})`\n                      : node.status.label}\n                  </span>\n                )}\n\n                <Dropdown>\n                  <Dropdown.Toggle\n                    className={classNames(styles.toggle, {\n                      [styles.disabled]: pending\n                    })}\n                  >\n                    <span>Action</span>\n\n                    <div className={styles.angle}>\n                      <FontAwesomeIcon icon={faAngleDown} />\n                    </div>\n                  </Dropdown.Toggle>\n\n                  <Dropdown.Menu className={styles.menu}>\n                    {actions.map((action) => {\n                      const disabled = !node.status.actions.includes(\n                        action.key\n                      );\n\n                      return (\n                        <Dropdown.Item\n                          key={action.key}\n                          className={classNames(styles.action, {\n                            [styles.disabled]: disabled\n                          })}\n                          onClick={() => {\n                            onAct(action.callback(node.code));\n                          }}\n                        >\n                          {action.label}\n                        </Dropdown.Item>\n                      );\n                    })}\n                  </Dropdown.Menu>\n                </Dropdown>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}