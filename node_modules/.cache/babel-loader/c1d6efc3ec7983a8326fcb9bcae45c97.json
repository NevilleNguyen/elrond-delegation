{"ast":null,"code":"import{Address}from'@multiversx/sdk-core';import{ValidatorSecretKey}from'@multiversx/sdk-wallet';function hexStringToByte(str){if(!str){return new Uint8Array();}var a=[];for(var i=0,len=str.length;i<len;i+=2){a.push(parseInt(str.substr(i,2),16));}return new Uint8Array(a);}function getPubKey(file,indices){var headerParts=file.toString().substring(indices[0],indices[1]).split(' ');return headerParts[4]?headerParts[4]:'';}export default function decodeFile(file,delegationContract){var myKey=ValidatorSecretKey.fromPem(file);var dsc=new Address(delegationContract);var signature=myKey.sign(Buffer.from(dsc.pubkey())).toString('hex');var regex=/-----/gi;var result;var indices=[];while(result=regex.exec(file.toString())){indices.push(result.index);}var key=file.toString().substring(indices[1]+6,indices[2]-1);var decoded=window.atob(key);var value=hexStringToByte(decoded);var pubKey=getPubKey(file,indices);return{value:value,pubKey:pubKey,signature:signature};}","map":{"version":3,"names":["Address","ValidatorSecretKey","hexStringToByte","str","Uint8Array","a","i","len","length","push","parseInt","substr","getPubKey","file","indices","headerParts","toString","substring","split","decodeFile","delegationContract","myKey","fromPem","dsc","signature","sign","Buffer","from","pubkey","regex","result","exec","index","key","decoded","window","atob","value","pubKey"],"sources":["/Users/neville/Documents/Github/elrond-delegation/src/components/Nodes/components/Dropzone/helpers.ts"],"sourcesContent":["import { Address } from '@multiversx/sdk-core';\nimport { ValidatorSecretKey } from '@multiversx/sdk-wallet';\n\nfunction hexStringToByte(str: string) {\n  if (!str) {\n    return new Uint8Array();\n  }\n  const a = [];\n  for (let i = 0, len = str.length; i < len; i += 2) {\n    a.push(parseInt(str.substr(i, 2), 16));\n  }\n  return new Uint8Array(a);\n}\n\nfunction getPubKey(file: string, indices: any[]) {\n  const headerParts = file\n    .toString()\n    .substring(indices[0], indices[1])\n    .split(' ');\n  return headerParts[4] ? headerParts[4] : '';\n}\n\nexport default function decodeFile(file: string, delegationContract?: string) {\n  const myKey = ValidatorSecretKey.fromPem(file);\n  const dsc = new Address(delegationContract);\n  const signature = myKey.sign(Buffer.from(dsc.pubkey())).toString('hex');\n\n  const regex = /-----/gi;\n  let result;\n  const indices = [];\n  while ((result = regex.exec(file.toString()))) {\n    indices.push(result.index);\n  }\n\n  const key = file.toString().substring(indices[1] + 6, indices[2] - 1);\n  const decoded = window.atob(key);\n\n  const value = hexStringToByte(decoded);\n  const pubKey = getPubKey(file, indices);\n\n  return { value, pubKey, signature };\n}\n"],"mappings":"AAAA,OAASA,OAAO,KAAQ,sBAAsB,CAC9C,OAASC,kBAAkB,KAAQ,wBAAwB,CAE3D,QAAS,CAAAC,eAAeA,CAACC,GAAW,CAAE,CACpC,GAAI,CAACA,GAAG,CAAE,CACR,MAAO,IAAI,CAAAC,UAAU,EAAE,CACzB,CACA,GAAM,CAAAC,CAAC,CAAG,EAAE,CACZ,IAAK,GAAI,CAAAC,CAAC,CAAG,CAAC,CAAEC,GAAG,CAAGJ,GAAG,CAACK,MAAM,CAAEF,CAAC,CAAGC,GAAG,CAAED,CAAC,EAAI,CAAC,CAAE,CACjDD,CAAC,CAACI,IAAI,CAACC,QAAQ,CAACP,GAAG,CAACQ,MAAM,CAACL,CAAC,CAAE,CAAC,CAAC,CAAE,EAAE,CAAC,CAAC,CACxC,CACA,MAAO,IAAI,CAAAF,UAAU,CAACC,CAAC,CAAC,CAC1B,CAEA,QAAS,CAAAO,SAASA,CAACC,IAAY,CAAEC,OAAc,CAAE,CAC/C,GAAM,CAAAC,WAAW,CAAGF,IAAI,CACrBG,QAAQ,EAAE,CACVC,SAAS,CAACH,OAAO,CAAC,CAAC,CAAC,CAAEA,OAAO,CAAC,CAAC,CAAC,CAAC,CACjCI,KAAK,CAAC,GAAG,CAAC,CACb,MAAO,CAAAH,WAAW,CAAC,CAAC,CAAC,CAAGA,WAAW,CAAC,CAAC,CAAC,CAAG,EAAE,CAC7C,CAEA,cAAe,SAAS,CAAAI,UAAUA,CAACN,IAAY,CAAEO,kBAA2B,CAAE,CAC5E,GAAM,CAAAC,KAAK,CAAGpB,kBAAkB,CAACqB,OAAO,CAACT,IAAI,CAAC,CAC9C,GAAM,CAAAU,GAAG,CAAG,GAAI,CAAAvB,OAAO,CAACoB,kBAAkB,CAAC,CAC3C,GAAM,CAAAI,SAAS,CAAGH,KAAK,CAACI,IAAI,CAACC,MAAM,CAACC,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAE,CAAC,CAAC,CAACZ,QAAQ,CAAC,KAAK,CAAC,CAEvE,GAAM,CAAAa,KAAK,CAAG,SAAS,CACvB,GAAI,CAAAC,MAAM,CACV,GAAM,CAAAhB,OAAO,CAAG,EAAE,CAClB,MAAQgB,MAAM,CAAGD,KAAK,CAACE,IAAI,CAAClB,IAAI,CAACG,QAAQ,EAAE,CAAC,CAAG,CAC7CF,OAAO,CAACL,IAAI,CAACqB,MAAM,CAACE,KAAK,CAAC,CAC5B,CAEA,GAAM,CAAAC,GAAG,CAAGpB,IAAI,CAACG,QAAQ,EAAE,CAACC,SAAS,CAACH,OAAO,CAAC,CAAC,CAAC,CAAG,CAAC,CAAEA,OAAO,CAAC,CAAC,CAAC,CAAG,CAAC,CAAC,CACrE,GAAM,CAAAoB,OAAO,CAAGC,MAAM,CAACC,IAAI,CAACH,GAAG,CAAC,CAEhC,GAAM,CAAAI,KAAK,CAAGnC,eAAe,CAACgC,OAAO,CAAC,CACtC,GAAM,CAAAI,MAAM,CAAG1B,SAAS,CAACC,IAAI,CAAEC,OAAO,CAAC,CAEvC,MAAO,CAAEuB,KAAK,CAALA,KAAK,CAAEC,MAAM,CAANA,MAAM,CAAEd,SAAS,CAATA,SAAU,CAAC,CACrC"},"metadata":{},"sourceType":"module"}