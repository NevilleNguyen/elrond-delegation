{"ast":null,"code":"import _regeneratorRuntime from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _slicedToArray from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { a as h } from \"./chunk-KVVBB443.js\";\nimport { a as I } from \"./chunk-XNZGF3PO.js\";\nimport { a as T } from \"./chunk-QFKT22AW.js\";\nimport { c as w } from \"./chunk-G3PZHPKZ.js\";\nimport { a as M } from \"./chunk-6AWYFPQL.js\";\nimport { a as y } from \"./chunk-CSUZ4NMB.js\";\nimport { b as u, c as G } from \"./chunk-EC436OTI.js\";\nimport { h as L, i as D } from \"./chunk-QR72MI4M.js\";\nimport { o as U } from \"./chunk-K2GW23ZC.js\";\nimport { a as d, j as f, m } from \"./chunk-HBP5N4FR.js\";\nm();\nD();\nimport { useState as E } from \"react\";\nimport { ExtensionProvider as _ } from \"@multiversx/sdk-extension-provider\";\nG();\nU();\nM();\nvar Y = function Y(_ref) {\n  var n = _ref.callbackRoute,\n    v = _ref.token,\n    c = _ref.nativeAuth,\n    S = _ref.onLoginRedirect;\n  var _E = E(\"\"),\n    _E2 = _slicedToArray(_E, 2),\n    l = _E2[0],\n    x = _E2[1],\n    _E3 = E(!1),\n    _E4 = _slicedToArray(_E3, 2),\n    P = _E4[0],\n    t = _E4[1],\n    O = c != null,\n    r = I(c),\n    o = v,\n    k = w(),\n    p = h();\n  function A() {\n    return f(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var i, F, N, _i$account, a, e;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            if (!p) {\n              _context.next = 2;\n              break;\n            }\n            throw new Error(L);\n          case 2:\n            t(!0);\n            i = _.getInstance();\n            _context.prev = 4;\n            _context.next = 7;\n            return i.init();\n          case 7:\n            if (_context.sent) {\n              _context.next = 10;\n              break;\n            }\n            console.warn(\"Something went wrong trying to redirect to wallet login..\");\n            return _context.abrupt(\"return\");\n          case 10:\n            F = encodeURIComponent(\"\".concat(window == null ? void 0 : window.location.origin).concat(n != null ? n : window == null ? void 0 : window.location.pathname));\n            _context.t0 = O && !o;\n            if (!_context.t0) {\n              _context.next = 17;\n              break;\n            }\n            _context.next = 15;\n            return r.getNativeAuthLoginToken();\n          case 15:\n            o = _context.sent;\n            _context.t0 = !o;\n          case 17:\n            if (!_context.t0) {\n              _context.next = 20;\n              break;\n            }\n            console.warn(\"Fetching block failed. Login cancelled.\");\n            return _context.abrupt(\"return\");\n          case 20:\n            o && r.setLoginToken(o);\n            N = d({\n              callbackUrl: F\n            }, o && {\n              token: o\n            });\n            _context.next = 24;\n            return i.login(N);\n          case 24:\n            T(i);\n            _i$account = i.account, a = _i$account.signature, e = _i$account.address;\n            if (e) {\n              _context.next = 29;\n              break;\n            }\n            t(!1), console.warn(\"Login cancelled.\");\n            return _context.abrupt(\"return\");\n          case 29:\n            a && o && r.setTokenLoginInfo({\n              signature: a,\n              address: e\n            }), k(u({\n              address: e,\n              loginMethod: \"extension\"\n            })), y({\n              callbackRoute: n,\n              onLoginRedirect: S,\n              options: {\n                signature: a,\n                address: e\n              }\n            });\n            _context.next = 35;\n            break;\n          case 32:\n            _context.prev = 32;\n            _context.t1 = _context[\"catch\"](4);\n            console.error(\"error loging in\", _context.t1), x(\"error logging in\" + _context.t1.message);\n          case 35:\n            _context.prev = 35;\n            t(!1);\n            return _context.finish(35);\n          case 38:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[4, 32, 35, 38]]);\n    }));\n  }\n  var s = Boolean(l);\n  return [A, {\n    loginFailed: s,\n    error: l,\n    isLoading: P && !s,\n    isLoggedIn: p && !s\n  }];\n};\nexport { Y as a };","map":{"version":3,"names":["a","h","I","T","c","w","M","y","b","u","G","L","i","D","o","U","d","j","f","m","useState","E","ExtensionProvider","_","Y","_ref","n","callbackRoute","v","token","nativeAuth","S","onLoginRedirect","_E","_E2","_slicedToArray","l","x","_E3","_E4","P","t","O","r","k","p","A","_regeneratorRuntime","mark","_callee","F","N","_i$account","e","wrap","_callee$","_context","prev","next","Error","getInstance","init","sent","console","warn","abrupt","encodeURIComponent","concat","window","location","origin","pathname","t0","getNativeAuthLoginToken","setLoginToken","callbackUrl","login","account","signature","address","setTokenLoginInfo","loginMethod","options","t1","error","message","finish","stop","s","Boolean","loginFailed","isLoading","isLoggedIn"],"sources":["/Users/neville/Documents/Github/elrond-delegation/node_modules/@multiversx/sdk-dapp/__chunks__/chunk-3IQVAJO6.js"],"sourcesContent":["import{a as h}from\"./chunk-KVVBB443.js\";import{a as I}from\"./chunk-XNZGF3PO.js\";import{a as T}from\"./chunk-QFKT22AW.js\";import{c as w}from\"./chunk-G3PZHPKZ.js\";import{a as M}from\"./chunk-6AWYFPQL.js\";import{a as y}from\"./chunk-CSUZ4NMB.js\";import{b as u,c as G}from\"./chunk-EC436OTI.js\";import{h as L,i as D}from\"./chunk-QR72MI4M.js\";import{o as U}from\"./chunk-K2GW23ZC.js\";import{a as d,j as f,m}from\"./chunk-HBP5N4FR.js\";m();D();import{useState as E}from\"react\";import{ExtensionProvider as _}from\"@multiversx/sdk-extension-provider\";G();U();M();var Y=({callbackRoute:n,token:v,nativeAuth:c,onLoginRedirect:S})=>{let[l,x]=E(\"\"),[P,t]=E(!1),O=c!=null,r=I(c),o=v,k=w(),p=h();function A(){return f(this,null,function*(){if(p)throw new Error(L);t(!0);let i=_.getInstance();try{if(!(yield i.init())){console.warn(\"Something went wrong trying to redirect to wallet login..\");return}let F=encodeURIComponent(`${window==null?void 0:window.location.origin}${n!=null?n:window==null?void 0:window.location.pathname}`);if(O&&!o&&(o=yield r.getNativeAuthLoginToken(),!o)){console.warn(\"Fetching block failed. Login cancelled.\");return}o&&r.setLoginToken(o);let N=d({callbackUrl:F},o&&{token:o});yield i.login(N),T(i);let{signature:a,address:e}=i.account;if(!e){t(!1),console.warn(\"Login cancelled.\");return}a&&o&&r.setTokenLoginInfo({signature:a,address:e}),k(u({address:e,loginMethod:\"extension\"})),y({callbackRoute:n,onLoginRedirect:S,options:{signature:a,address:e}})}catch(g){console.error(\"error loging in\",g),x(\"error logging in\"+g.message)}finally{t(!1)}})}let s=Boolean(l);return[A,{loginFailed:s,error:l,isLoading:P&&!s,isLoggedIn:p&&!s}]};export{Y as a};\n//# sourceMappingURL=chunk-3IQVAJO6.js.map\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}