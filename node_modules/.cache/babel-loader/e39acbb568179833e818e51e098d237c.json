{"ast":null,"code":"import _defineProperty from\"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _regeneratorRuntime from\"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React from'react';import BigNumber from'bignumber.js';import classNames from'classnames';import{Formik}from'formik';import{string,object}from'yup';import{Submit}from'components/Action';import{network}from'config';import{useGlobalContext}from'context';import{denominated}from'helpers/denominate';import{nominateValToHex}from'helpers/nominate';import useTransaction from'helpers/useTransaction';import styles from'./styles.module.scss';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var ChangeDelegationCap=function ChangeDelegationCap(){var _useTransaction=useTransaction(),sendTransaction=_useTransaction.sendTransaction;var _useGlobalContext=useGlobalContext(),contractDetails=_useGlobalContext.contractDetails,totalActiveStake=_useGlobalContext.totalActiveStake;var minimum=denominated(totalActiveStake.data||'',{addCommas:false});var total=denominated(contractDetails.data?contractDetails.data.delegationCap:'',{addCommas:false});var validationSchema=object().shape({amount:string().required('Required').test('minimum',\"Minimum \".concat(minimum,\" \").concat(network.egldLabel,\" or 0 \").concat(network.egldLabel),function(){var value=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return new BigNumber(value).isGreaterThanOrEqualTo(minimum)||value==='0';})});var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(data){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return sendTransaction({args:nominateValToHex(data.amount.toString()),type:'modifyTotalDelegationCap',value:'0'});case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.error(_context.t0);case 8:case\"end\":return _context.stop();}},_callee,null,[[0,5]]);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"\".concat(styles.cap,\" cap\"),children:/*#__PURE__*/_jsx(Formik,{validationSchema:validationSchema,onSubmit:onSubmit,initialValues:{amount:total},children:function children(_ref2){var errors=_ref2.errors,values=_ref2.values,touched=_ref2.touched,handleChange=_ref2.handleChange,handleBlur=_ref2.handleBlur,handleSubmit=_ref2.handleSubmit;return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.field,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"amount\",children:\"Update Delegation Cap\"}),/*#__PURE__*/_jsx(\"div\",{className:styles.group,children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",name:\"amount\",step:\"any\",required:true,autoComplete:\"off\",min:0,value:values.amount,onBlur:handleBlur,onChange:handleChange,className:classNames(styles.input,_defineProperty({},styles.invalid,errors.amount&&touched.amount))})}),errors.amount&&touched.amount&&/*#__PURE__*/_jsx(\"span\",{className:styles.error,children:errors.amount})]}),/*#__PURE__*/_jsx(Submit,{close:\"Cancel\",submit:\"Continue\"})]});}})});};","map":{"version":3,"names":["React","BigNumber","classNames","Formik","string","object","Submit","network","useGlobalContext","denominated","nominateValToHex","useTransaction","styles","jsx","_jsx","jsxs","_jsxs","ChangeDelegationCap","_useTransaction","sendTransaction","_useGlobalContext","contractDetails","totalActiveStake","minimum","data","addCommas","total","delegationCap","validationSchema","shape","amount","required","test","concat","egldLabel","value","arguments","length","undefined","isGreaterThanOrEqualTo","onSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","args","toString","type","t0","console","error","stop","_x","apply","className","cap","children","initialValues","_ref2","errors","values","touched","handleChange","handleBlur","handleSubmit","field","htmlFor","group","name","step","autoComplete","min","onBlur","onChange","input","_defineProperty","invalid","close","submit"],"sources":["/Users/neville/Documents/Github/elrond-delegation/src/components/Cards/components/ChangeDelegationCap/ChangeDelegationCap.tsx"],"sourcesContent":["import React from 'react';\nimport BigNumber from 'bignumber.js';\nimport classNames from 'classnames';\nimport { Formik } from 'formik';\nimport { string, object } from 'yup';\n\nimport { Submit } from 'components/Action';\nimport { network } from 'config';\nimport { useGlobalContext } from 'context';\nimport { denominated } from 'helpers/denominate';\nimport { nominateValToHex } from 'helpers/nominate';\nimport useTransaction from 'helpers/useTransaction';\n\nimport styles from './styles.module.scss';\n\ninterface ActionDataType {\n  amount: string;\n}\n\nexport const ChangeDelegationCap = () => {\n  const { sendTransaction } = useTransaction();\n  const { contractDetails, totalActiveStake } = useGlobalContext();\n\n  const minimum = denominated(totalActiveStake.data || '', {\n    addCommas: false\n  });\n\n  const total = denominated(\n    contractDetails.data ? contractDetails.data.delegationCap : '',\n    {\n      addCommas: false\n    }\n  );\n\n  const validationSchema = object().shape({\n    amount: string()\n      .required('Required')\n      .test(\n        'minimum',\n        `Minimum ${minimum} ${network.egldLabel} or 0 ${network.egldLabel}`,\n        (value = '') =>\n          new BigNumber(value).isGreaterThanOrEqualTo(minimum) || value === '0'\n      )\n  });\n\n  const onSubmit = async (data: ActionDataType): Promise<void> => {\n    try {\n      await sendTransaction({\n        args: nominateValToHex(data.amount.toString()),\n        type: 'modifyTotalDelegationCap',\n        value: '0'\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  return (\n    <div className={`${styles.cap} cap`}>\n      <Formik\n        validationSchema={validationSchema}\n        onSubmit={onSubmit}\n        initialValues={{\n          amount: total\n        }}\n      >\n        {({\n          errors,\n          values,\n          touched,\n          handleChange,\n          handleBlur,\n          handleSubmit\n        }) => (\n          <form onSubmit={handleSubmit}>\n            <div className={styles.field}>\n              <label htmlFor='amount'>Update Delegation Cap</label>\n\n              <div className={styles.group}>\n                <input\n                  type='number'\n                  name='amount'\n                  step='any'\n                  required={true}\n                  autoComplete='off'\n                  min={0}\n                  value={values.amount}\n                  onBlur={handleBlur}\n                  onChange={handleChange}\n                  className={classNames(styles.input, {\n                    [styles.invalid]: errors.amount && touched.amount\n                  })}\n                />\n              </div>\n\n              {errors.amount && touched.amount && (\n                <span className={styles.error}>{errors.amount}</span>\n              )}\n            </div>\n\n            <Submit close='Cancel' submit='Continue' />\n          </form>\n        )}\n      </Formik>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}