{"ast":null,"code":"import { Address } from '@multiversx/sdk-core';\nimport { ValidatorSecretKey } from '@multiversx/sdk-wallet';\nfunction hexStringToByte(str) {\n  if (!str) {\n    return new Uint8Array();\n  }\n  var a = [];\n  for (var i = 0, len = str.length; i < len; i += 2) {\n    a.push(parseInt(str.substr(i, 2), 16));\n  }\n  return new Uint8Array(a);\n}\nfunction getPubKey(file, indices) {\n  var headerParts = file.toString().substring(indices[0], indices[1]).split(' ');\n  return headerParts[4] ? headerParts[4] : '';\n}\nexport default function decodeFile(file, delegationContract) {\n  var myKey = ValidatorSecretKey.fromPem(file);\n  var dsc = new Address(delegationContract);\n  var signature = myKey.sign(Buffer.from(dsc.pubkey())).toString('hex');\n  var regex = /-----/gi;\n  var result;\n  var indices = [];\n  while (result = regex.exec(file.toString())) {\n    indices.push(result.index);\n  }\n  var key = file.toString().substring(indices[1] + 6, indices[2] - 1);\n  var decoded = window.atob(key);\n  var value = hexStringToByte(decoded);\n  var pubKey = getPubKey(file, indices);\n  return {\n    value: value,\n    pubKey: pubKey,\n    signature: signature\n  };\n}","map":{"version":3,"names":["Address","ValidatorSecretKey","hexStringToByte","str","Uint8Array","a","i","len","length","push","parseInt","substr","getPubKey","file","indices","headerParts","toString","substring","split","decodeFile","delegationContract","myKey","fromPem","dsc","signature","sign","Buffer","from","pubkey","regex","result","exec","index","key","decoded","window","atob","value","pubKey"],"sources":["/Users/neville/Documents/Github/elrond-delegation/src/components/Nodes/components/Dropzone/helpers.ts"],"sourcesContent":["import { Address } from '@multiversx/sdk-core';\nimport { ValidatorSecretKey } from '@multiversx/sdk-wallet';\n\nfunction hexStringToByte(str: string) {\n  if (!str) {\n    return new Uint8Array();\n  }\n  const a = [];\n  for (let i = 0, len = str.length; i < len; i += 2) {\n    a.push(parseInt(str.substr(i, 2), 16));\n  }\n  return new Uint8Array(a);\n}\n\nfunction getPubKey(file: string, indices: any[]) {\n  const headerParts = file\n    .toString()\n    .substring(indices[0], indices[1])\n    .split(' ');\n  return headerParts[4] ? headerParts[4] : '';\n}\n\nexport default function decodeFile(file: string, delegationContract?: string) {\n  const myKey = ValidatorSecretKey.fromPem(file);\n  const dsc = new Address(delegationContract);\n  const signature = myKey.sign(Buffer.from(dsc.pubkey())).toString('hex');\n\n  const regex = /-----/gi;\n  let result;\n  const indices = [];\n  while ((result = regex.exec(file.toString()))) {\n    indices.push(result.index);\n  }\n\n  const key = file.toString().substring(indices[1] + 6, indices[2] - 1);\n  const decoded = window.atob(key);\n\n  const value = hexStringToByte(decoded);\n  const pubKey = getPubKey(file, indices);\n\n  return { value, pubKey, signature };\n}\n"],"mappings":"AAAA,SAASA,OAAO,QAAQ,sBAAsB;AAC9C,SAASC,kBAAkB,QAAQ,wBAAwB;AAE3D,SAASC,eAAeA,CAACC,GAAW,EAAE;EACpC,IAAI,CAACA,GAAG,EAAE;IACR,OAAO,IAAIC,UAAU,EAAE;EACzB;EACA,IAAMC,CAAC,GAAG,EAAE;EACZ,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEC,GAAG,GAAGJ,GAAG,CAACK,MAAM,EAAEF,CAAC,GAAGC,GAAG,EAAED,CAAC,IAAI,CAAC,EAAE;IACjDD,CAAC,CAACI,IAAI,CAACC,QAAQ,CAACP,GAAG,CAACQ,MAAM,CAACL,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC;EACxC;EACA,OAAO,IAAIF,UAAU,CAACC,CAAC,CAAC;AAC1B;AAEA,SAASO,SAASA,CAACC,IAAY,EAAEC,OAAc,EAAE;EAC/C,IAAMC,WAAW,GAAGF,IAAI,CACrBG,QAAQ,EAAE,CACVC,SAAS,CAACH,OAAO,CAAC,CAAC,CAAC,EAAEA,OAAO,CAAC,CAAC,CAAC,CAAC,CACjCI,KAAK,CAAC,GAAG,CAAC;EACb,OAAOH,WAAW,CAAC,CAAC,CAAC,GAAGA,WAAW,CAAC,CAAC,CAAC,GAAG,EAAE;AAC7C;AAEA,eAAe,SAASI,UAAUA,CAACN,IAAY,EAAEO,kBAA2B,EAAE;EAC5E,IAAMC,KAAK,GAAGpB,kBAAkB,CAACqB,OAAO,CAACT,IAAI,CAAC;EAC9C,IAAMU,GAAG,GAAG,IAAIvB,OAAO,CAACoB,kBAAkB,CAAC;EAC3C,IAAMI,SAAS,GAAGH,KAAK,CAACI,IAAI,CAACC,MAAM,CAACC,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAE,CAAC,CAAC,CAACZ,QAAQ,CAAC,KAAK,CAAC;EAEvE,IAAMa,KAAK,GAAG,SAAS;EACvB,IAAIC,MAAM;EACV,IAAMhB,OAAO,GAAG,EAAE;EAClB,OAAQgB,MAAM,GAAGD,KAAK,CAACE,IAAI,CAAClB,IAAI,CAACG,QAAQ,EAAE,CAAC,EAAG;IAC7CF,OAAO,CAACL,IAAI,CAACqB,MAAM,CAACE,KAAK,CAAC;EAC5B;EAEA,IAAMC,GAAG,GAAGpB,IAAI,CAACG,QAAQ,EAAE,CAACC,SAAS,CAACH,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,EAAEA,OAAO,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;EACrE,IAAMoB,OAAO,GAAGC,MAAM,CAACC,IAAI,CAACH,GAAG,CAAC;EAEhC,IAAMI,KAAK,GAAGnC,eAAe,CAACgC,OAAO,CAAC;EACtC,IAAMI,MAAM,GAAG1B,SAAS,CAACC,IAAI,EAAEC,OAAO,CAAC;EAEvC,OAAO;IAAEuB,KAAK,EAALA,KAAK;IAAEC,MAAM,EAANA,MAAM;IAAEd,SAAS,EAATA;EAAU,CAAC;AACrC"},"metadata":{},"sourceType":"module"}