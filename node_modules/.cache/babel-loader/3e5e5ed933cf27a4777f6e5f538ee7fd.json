{"ast":null,"code":"import _regeneratorRuntime from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _slicedToArray from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport { a as h } from \"./chunk-KVVBB443.js\";\nimport { a as I } from \"./chunk-XNZGF3PO.js\";\nimport { a as T } from \"./chunk-QFKT22AW.js\";\nimport { c as w } from \"./chunk-G3PZHPKZ.js\";\nimport { a as _ } from \"./chunk-6AWYFPQL.js\";\nimport { a as y } from \"./chunk-CSUZ4NMB.js\";\nimport { b as u, c as M } from \"./chunk-EC436OTI.js\";\nimport { h as L, i as G } from \"./chunk-QR72MI4M.js\";\nimport { o as D } from \"./chunk-K2GW23ZC.js\";\nimport { a as d, j as f, m } from \"./chunk-HBP5N4FR.js\";\nm();\nG();\nimport { useState as v } from \"react\";\nimport { OperaProvider as x } from \"@multiversx/sdk-opera-provider\";\nM();\nD();\n_();\nvar Y = function Y(_ref) {\n  var n = _ref.callbackRoute,\n    O = _ref.token,\n    c = _ref.nativeAuth,\n    S = _ref.onLoginRedirect;\n  var _v = v(\"\"),\n    _v2 = _slicedToArray(_v, 2),\n    p = _v2[0],\n    E = _v2[1],\n    _v3 = v(!1),\n    _v4 = _slicedToArray(_v3, 2),\n    P = _v4[0],\n    r = _v4[1],\n    k = c != null,\n    t = I(c),\n    o = O,\n    A = w(),\n    l = h();\n  function F() {\n    return f(this, null, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n      var i, N, U, _i$account, g, e;\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            if (!l) {\n              _context.next = 2;\n              break;\n            }\n            throw new Error(L);\n          case 2:\n            r(!0);\n            i = x.getInstance();\n            _context.prev = 4;\n            _context.next = 7;\n            return i.init();\n          case 7:\n            if (_context.sent) {\n              _context.next = 10;\n              break;\n            }\n            console.warn(\"Something went wrong trying to redirect to wallet login..\");\n            return _context.abrupt(\"return\");\n          case 10:\n            N = encodeURIComponent(\"\".concat(window == null ? void 0 : window.location.origin).concat(n != null ? n : window == null ? void 0 : window.location.pathname));\n            _context.t0 = k && !o;\n            if (!_context.t0) {\n              _context.next = 17;\n              break;\n            }\n            _context.next = 15;\n            return t.getNativeAuthLoginToken();\n          case 15:\n            o = _context.sent;\n            _context.t0 = !o;\n          case 17:\n            if (!_context.t0) {\n              _context.next = 20;\n              break;\n            }\n            console.warn(\"Fetching block failed. Login cancelled.\");\n            return _context.abrupt(\"return\");\n          case 20:\n            o && t.setLoginToken(o);\n            U = d({\n              callbackUrl: N\n            }, o && {\n              token: o\n            });\n            _context.next = 24;\n            return i.login(U);\n          case 24:\n            T(i);\n            _i$account = i.account, g = _i$account.signature, e = _i$account.address;\n            if (e) {\n              _context.next = 29;\n              break;\n            }\n            r(!1), console.warn(\"Login cancelled.\");\n            return _context.abrupt(\"return\");\n          case 29:\n            g && o && t.setTokenLoginInfo({\n              signature: g,\n              address: e\n            }), A(u({\n              address: e,\n              loginMethod: \"opera\"\n            })), y({\n              callbackRoute: n,\n              onLoginRedirect: S,\n              options: {\n                signature: g,\n                address: e\n              }\n            });\n            _context.next = 35;\n            break;\n          case 32:\n            _context.prev = 32;\n            _context.t1 = _context[\"catch\"](4);\n            console.error(\"error loging in\", _context.t1), E(\"error logging in\" + _context.t1.message);\n          case 35:\n            _context.prev = 35;\n            r(!1);\n            return _context.finish(35);\n          case 38:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[4, 32, 35, 38]]);\n    }));\n  }\n  var s = Boolean(p);\n  return [F, {\n    loginFailed: s,\n    error: p,\n    isLoading: P && !s,\n    isLoggedIn: l && !s\n  }];\n};\nexport { Y as a };","map":{"version":3,"names":["a","h","I","T","c","w","_","y","b","u","M","L","i","G","o","D","d","j","f","m","useState","v","OperaProvider","x","Y","_ref","n","callbackRoute","O","token","nativeAuth","S","onLoginRedirect","_v","_v2","_slicedToArray","p","E","_v3","_v4","P","r","k","t","A","l","F","_regeneratorRuntime","mark","_callee","N","U","_i$account","g","e","wrap","_callee$","_context","prev","next","Error","getInstance","init","sent","console","warn","abrupt","encodeURIComponent","concat","window","location","origin","pathname","t0","getNativeAuthLoginToken","setLoginToken","callbackUrl","login","account","signature","address","setTokenLoginInfo","loginMethod","options","t1","error","message","finish","stop","s","Boolean","loginFailed","isLoading","isLoggedIn"],"sources":["/Users/neville/Documents/Github/elrond-delegation/node_modules/@multiversx/sdk-dapp/__chunks__/chunk-LFKXTV7X.js"],"sourcesContent":["import{a as h}from\"./chunk-KVVBB443.js\";import{a as I}from\"./chunk-XNZGF3PO.js\";import{a as T}from\"./chunk-QFKT22AW.js\";import{c as w}from\"./chunk-G3PZHPKZ.js\";import{a as _}from\"./chunk-6AWYFPQL.js\";import{a as y}from\"./chunk-CSUZ4NMB.js\";import{b as u,c as M}from\"./chunk-EC436OTI.js\";import{h as L,i as G}from\"./chunk-QR72MI4M.js\";import{o as D}from\"./chunk-K2GW23ZC.js\";import{a as d,j as f,m}from\"./chunk-HBP5N4FR.js\";m();G();import{useState as v}from\"react\";import{OperaProvider as x}from\"@multiversx/sdk-opera-provider\";M();D();_();var Y=({callbackRoute:n,token:O,nativeAuth:c,onLoginRedirect:S})=>{let[p,E]=v(\"\"),[P,r]=v(!1),k=c!=null,t=I(c),o=O,A=w(),l=h();function F(){return f(this,null,function*(){if(l)throw new Error(L);r(!0);let i=x.getInstance();try{if(!(yield i.init())){console.warn(\"Something went wrong trying to redirect to wallet login..\");return}let N=encodeURIComponent(`${window==null?void 0:window.location.origin}${n!=null?n:window==null?void 0:window.location.pathname}`);if(k&&!o&&(o=yield t.getNativeAuthLoginToken(),!o)){console.warn(\"Fetching block failed. Login cancelled.\");return}o&&t.setLoginToken(o);let U=d({callbackUrl:N},o&&{token:o});yield i.login(U),T(i);let{signature:g,address:e}=i.account;if(!e){r(!1),console.warn(\"Login cancelled.\");return}g&&o&&t.setTokenLoginInfo({signature:g,address:e}),A(u({address:e,loginMethod:\"opera\"})),y({callbackRoute:n,onLoginRedirect:S,options:{signature:g,address:e}})}catch(a){console.error(\"error loging in\",a),E(\"error logging in\"+a.message)}finally{r(!1)}})}let s=Boolean(p);return[F,{loginFailed:s,error:p,isLoading:P&&!s,isLoggedIn:l&&!s}]};export{Y as a};\n//# sourceMappingURL=chunk-LFKXTV7X.js.map\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}