{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _classCallCheck = require(\"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserSigner = void 0;\nvar errors_1 = require(\"./errors\");\nvar userAddress_1 = require(\"./userAddress\");\nvar userKeys_1 = require(\"./userKeys\");\nvar userWallet_1 = require(\"./userWallet\");\n/**\n * ed25519 signer\n */\nvar UserSigner = /*#__PURE__*/function () {\n  function UserSigner(secretKey) {\n    _classCallCheck(this, UserSigner);\n    this.secretKey = secretKey;\n  }\n  _createClass(UserSigner, [{\n    key: \"sign\",\n    value: function sign(data) {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var signature;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              signature = this.secretKey.sign(data);\n              return _context.abrupt(\"return\", signature);\n            case 5:\n              _context.prev = 5;\n              _context.t0 = _context[\"catch\"](0);\n              throw new errors_1.ErrSignerCannotSign(_context.t0);\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this, [[0, 5]]);\n      }));\n    }\n    /**\n     * Gets the address of the signer.\n     */\n  }, {\n    key: \"getAddress\",\n    value: function getAddress() {\n      var bech32 = this.secretKey.generatePublicKey().toAddress().bech32();\n      return userAddress_1.UserAddress.fromBech32(bech32);\n    }\n  }], [{\n    key: \"fromWallet\",\n    value: function fromWallet(keyFileObject, password) {\n      var secretKey = userWallet_1.UserWallet.decryptSecretKey(keyFileObject, password);\n      return new UserSigner(secretKey);\n    }\n  }, {\n    key: \"fromPem\",\n    value: function fromPem(text) {\n      var index = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n      var secretKey = userKeys_1.UserSecretKey.fromPem(text, index);\n      return new UserSigner(secretKey);\n    }\n  }]);\n  return UserSigner;\n}();\nexports.UserSigner = UserSigner;","map":{"version":3,"sources":["../src/userSigner.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,QAAA,GAAA,OAAA,CAAA,UAAA,CAAA;AACA,IAAA,aAAA,GAAA,OAAA,CAAA,eAAA,CAAA;AACA,IAAA,UAAA,GAAA,OAAA,CAAA,YAAA,CAAA;AACA,IAAA,YAAA,GAAA,OAAA,CAAA,cAAA,CAAA;AAYA;;AAEG;AAFH,IAGa,UAAU;EAGnB,SAAA,WAAY,SAAyB,EAAA;IAAA,eAAA,OAAA,UAAA;IACjC,IAAI,CAAC,SAAS,GAAG,SAAS;EAC9B;EAAC,YAAA,CAAA,UAAA;IAAA,GAAA;IAAA,KAAA,EAYK,SAAA,KAAK,IAAY,EAAA;;;;;;;cAET,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC;cAAA,OAAA,QAAA,CAAA,MAAA,WACpC,SAAS;YAAA;cAAA,QAAA,CAAA,IAAA;cAAA,QAAA,CAAA,EAAA,GAAA,QAAA;cAAA,MAEV,IAAI,QAAA,CAAA,mBAAmB,CAAA,QAAA,CAAA,EAAA,CAAK;YAAA;YAAA;cAAA,OAAA,QAAA,CAAA,IAAA;UAAA;QAAA,GAAA,OAAA;MAAA,CAEzC,EAAA;IAAA;IAED;;AAEG;EAFH;IAAA,GAAA;IAAA,KAAA,EAGA,SAAA,WAAA,EAAU;MACN,IAAM,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,iBAAiB,EAAE,CAAC,SAAS,EAAE,CAAC,MAAM,EAAE;MACtE,OAAO,aAAA,CAAA,WAAW,CAAC,UAAU,CAAC,MAAM,CAAC;IACzC;EAAC;IAAA,GAAA;IAAA,KAAA,EAzBD,SAAA,WAAkB,aAAkB,EAAE,QAAgB,EAAA;MAClD,IAAI,SAAS,GAAG,YAAA,CAAA,UAAU,CAAC,gBAAgB,CAAC,aAAa,EAAE,QAAQ,CAAC;MACpE,OAAO,IAAI,UAAU,CAAC,SAAS,CAAC;IACpC;EAAC;IAAA,GAAA;IAAA,KAAA,EAED,SAAA,QAAe,IAAY,EAAmB;MAAA,IAAjB,KAAA,GAAA,SAAA,CAAA,MAAA,QAAA,SAAA,QAAA,SAAA,GAAA,SAAA,MAAgB,CAAC;MAC1C,IAAI,SAAS,GAAG,UAAA,CAAA,aAAa,CAAC,OAAO,CAAC,IAAI,EAAE,KAAK,CAAC;MAClD,OAAO,IAAI,UAAU,CAAC,SAAS,CAAC;IACpC;EAAC;EAAA,OAAA,UAAA;AAAA;AAfL,OAAA,CAAA,UAAA,GAAA,UAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UserSigner = void 0;\nconst errors_1 = require(\"./errors\");\nconst userAddress_1 = require(\"./userAddress\");\nconst userKeys_1 = require(\"./userKeys\");\nconst userWallet_1 = require(\"./userWallet\");\n/**\n * ed25519 signer\n */\nclass UserSigner {\n    constructor(secretKey) {\n        this.secretKey = secretKey;\n    }\n    static fromWallet(keyFileObject, password) {\n        let secretKey = userWallet_1.UserWallet.decryptSecretKey(keyFileObject, password);\n        return new UserSigner(secretKey);\n    }\n    static fromPem(text, index = 0) {\n        let secretKey = userKeys_1.UserSecretKey.fromPem(text, index);\n        return new UserSigner(secretKey);\n    }\n    sign(data) {\n        return __awaiter(this, void 0, void 0, function* () {\n            try {\n                const signature = this.secretKey.sign(data);\n                return signature;\n            }\n            catch (err) {\n                throw new errors_1.ErrSignerCannotSign(err);\n            }\n        });\n    }\n    /**\n     * Gets the address of the signer.\n     */\n    getAddress() {\n        const bech32 = this.secretKey.generatePublicKey().toAddress().bech32();\n        return userAddress_1.UserAddress.fromBech32(bech32);\n    }\n}\nexports.UserSigner = UserSigner;\n//# sourceMappingURL=userSigner.js.map"]},"metadata":{},"sourceType":"script"}