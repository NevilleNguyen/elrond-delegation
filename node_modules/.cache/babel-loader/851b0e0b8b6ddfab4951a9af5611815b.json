{"ast":null,"code":"import _defineProperty from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";\nimport _regeneratorRuntime from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/neville/Documents/Github/elrond-delegation/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _jsxFileName = \"/Users/neville/Documents/Github/elrond-delegation/src/components/Cards/components/ChangeDelegationCap/ChangeDelegationCap.tsx\",\n  _this = this,\n  _s = $RefreshSig$();\nimport React from 'react';\nimport BigNumber from 'bignumber.js';\nimport classNames from 'classnames';\nimport { Formik } from 'formik';\nimport { string, object } from 'yup';\nimport { Submit } from 'components/Action';\nimport { network } from 'config';\nimport { useGlobalContext } from 'context';\nimport { denominated } from 'helpers/denominate';\nimport { nominateValToHex } from 'helpers/nominate';\nimport useTransaction from 'helpers/useTransaction';\nimport styles from './styles.module.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport var ChangeDelegationCap = function ChangeDelegationCap() {\n  _s();\n  var _useTransaction = useTransaction(),\n    sendTransaction = _useTransaction.sendTransaction;\n  var _useGlobalContext = useGlobalContext(),\n    contractDetails = _useGlobalContext.contractDetails,\n    totalActiveStake = _useGlobalContext.totalActiveStake;\n  var minimum = denominated(totalActiveStake.data || '', {\n    addCommas: false\n  });\n  var total = denominated(contractDetails.data ? contractDetails.data.delegationCap : '', {\n    addCommas: false\n  });\n  var validationSchema = object().shape({\n    amount: string().required('Required').test('minimum', \"Minimum \".concat(minimum, \" \").concat(network.egldLabel, \" or 0 \").concat(network.egldLabel), function () {\n      var value = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n      return new BigNumber(value).isGreaterThanOrEqualTo(minimum) || value === '0';\n    })\n  });\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(data) {\n      return _regeneratorRuntime().wrap(function _callee$(_context) {\n        while (1) switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return sendTransaction({\n              args: nominateValToHex(data.amount.toString()),\n              type: 'modifyTotalDelegationCap',\n              value: '0'\n            });\n          case 3:\n            _context.next = 8;\n            break;\n          case 5:\n            _context.prev = 5;\n            _context.t0 = _context[\"catch\"](0);\n            console.error(_context.t0);\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }, _callee, null, [[0, 5]]);\n    }));\n    return function onSubmit(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"\".concat(styles.cap, \" cap\"),\n    children: /*#__PURE__*/_jsxDEV(Formik, {\n      validationSchema: validationSchema,\n      onSubmit: onSubmit,\n      initialValues: {\n        amount: total\n      },\n      children: function children(_ref2) {\n        var errors = _ref2.errors,\n          values = _ref2.values,\n          touched = _ref2.touched,\n          handleChange = _ref2.handleChange,\n          handleBlur = _ref2.handleBlur,\n          handleSubmit = _ref2.handleSubmit;\n        return /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.field,\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"amount\",\n              children: \"Update Delegation Cap\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 77,\n              columnNumber: 15\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: styles.group,\n              children: /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"number\",\n                name: \"amount\",\n                step: \"any\",\n                required: true,\n                autoComplete: \"off\",\n                min: 0,\n                value: values.amount,\n                onBlur: handleBlur,\n                onChange: handleChange,\n                className: classNames(styles.input, _defineProperty({}, styles.invalid, errors.amount && touched.amount))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 80,\n                columnNumber: 17\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 15\n            }, _this), errors.amount && touched.amount && /*#__PURE__*/_jsxDEV(\"span\", {\n              className: styles.error,\n              children: errors.amount\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 97,\n              columnNumber: 17\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 13\n          }, _this), /*#__PURE__*/_jsxDEV(Submit, {\n            close: \"Cancel\",\n            submit: \"Continue\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 11\n        }, _this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 5\n  }, _this);\n};\n_s(ChangeDelegationCap, \"rUvNmEbxHWxtymiuqobkswsTadU=\", false, function () {\n  return [useTransaction, useGlobalContext];\n});\n_c = ChangeDelegationCap;\nvar _c;\n$RefreshReg$(_c, \"ChangeDelegationCap\");","map":{"version":3,"names":["React","BigNumber","classNames","Formik","string","object","Submit","network","useGlobalContext","denominated","nominateValToHex","useTransaction","styles","jsxDEV","_jsxDEV","ChangeDelegationCap","_s","_useTransaction","sendTransaction","_useGlobalContext","contractDetails","totalActiveStake","minimum","data","addCommas","total","delegationCap","validationSchema","shape","amount","required","test","concat","egldLabel","value","arguments","length","undefined","isGreaterThanOrEqualTo","onSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","args","toString","type","t0","console","error","stop","_x","apply","className","cap","children","initialValues","_ref2","errors","values","touched","handleChange","handleBlur","handleSubmit","field","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","_this","group","name","step","autoComplete","min","onBlur","onChange","input","_defineProperty","invalid","close","submit","_c","$RefreshReg$"],"sources":["/Users/neville/Documents/Github/elrond-delegation/src/components/Cards/components/ChangeDelegationCap/ChangeDelegationCap.tsx"],"sourcesContent":["import React from 'react';\nimport BigNumber from 'bignumber.js';\nimport classNames from 'classnames';\nimport { Formik } from 'formik';\nimport { string, object } from 'yup';\n\nimport { Submit } from 'components/Action';\nimport { network } from 'config';\nimport { useGlobalContext } from 'context';\nimport { denominated } from 'helpers/denominate';\nimport { nominateValToHex } from 'helpers/nominate';\nimport useTransaction from 'helpers/useTransaction';\n\nimport styles from './styles.module.scss';\n\ninterface ActionDataType {\n  amount: string;\n}\n\nexport const ChangeDelegationCap = () => {\n  const { sendTransaction } = useTransaction();\n  const { contractDetails, totalActiveStake } = useGlobalContext();\n\n  const minimum = denominated(totalActiveStake.data || '', {\n    addCommas: false\n  });\n\n  const total = denominated(\n    contractDetails.data ? contractDetails.data.delegationCap : '',\n    {\n      addCommas: false\n    }\n  );\n\n  const validationSchema = object().shape({\n    amount: string()\n      .required('Required')\n      .test(\n        'minimum',\n        `Minimum ${minimum} ${network.egldLabel} or 0 ${network.egldLabel}`,\n        (value = '') =>\n          new BigNumber(value).isGreaterThanOrEqualTo(minimum) || value === '0'\n      )\n  });\n\n  const onSubmit = async (data: ActionDataType): Promise<void> => {\n    try {\n      await sendTransaction({\n        args: nominateValToHex(data.amount.toString()),\n        type: 'modifyTotalDelegationCap',\n        value: '0'\n      });\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  return (\n    <div className={`${styles.cap} cap`}>\n      <Formik\n        validationSchema={validationSchema}\n        onSubmit={onSubmit}\n        initialValues={{\n          amount: total\n        }}\n      >\n        {({\n          errors,\n          values,\n          touched,\n          handleChange,\n          handleBlur,\n          handleSubmit\n        }) => (\n          <form onSubmit={handleSubmit}>\n            <div className={styles.field}>\n              <label htmlFor='amount'>Update Delegation Cap</label>\n\n              <div className={styles.group}>\n                <input\n                  type='number'\n                  name='amount'\n                  step='any'\n                  required={true}\n                  autoComplete='off'\n                  min={0}\n                  value={values.amount}\n                  onBlur={handleBlur}\n                  onChange={handleChange}\n                  className={classNames(styles.input, {\n                    [styles.invalid]: errors.amount && touched.amount\n                  })}\n                />\n              </div>\n\n              {errors.amount && touched.amount && (\n                <span className={styles.error}>{errors.amount}</span>\n              )}\n            </div>\n\n            <Submit close='Cancel' submit='Continue' />\n          </form>\n        )}\n      </Formik>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}